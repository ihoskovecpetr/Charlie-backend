!function(e){var o={};function t(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var s in e)t.d(n,s,function(o){return e[o]}.bind(null,s));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="/",t(t.s=6)}([function(e,o){e.exports=require("mongoose")},function(e,o){e.exports=require("path")},function(e,o){e.exports=require("express")},function(e,o){e.exports=require("mongodb")},function(e,o){e.exports=require("body-parser")},function(e,o){var t={name:{type:String},geometry:{type:{type:String,default:"Point"},coordinates:{type:[Number]}},addressGoogle:{type:String},addressCustom:{type:String},eventType:{type:Number},dateStart:{type:Date},dateEnd:{type:Date},price:{type:Number},capacityMax:{type:Number},EventGuests:[{guest_id:{type:String},guest_email:{type:String},guest_name:{type:String},guest_photo:{type:String},guest_comment:{type:String},guest_confirmed:{type:Boolean},guest_pending:{type:Boolean},guest_inquiry:{type:String}}],BYO:{type:Boolean},repeatWeek:{type:Boolean},freeSnack:{type:Boolean},freeBeer:{type:Boolean},freeMeal:{type:Boolean},imagesArr:{type:Array},description:{type:String},confirmed:{type:Boolean},hide:{type:Boolean},creator_id:{type:String},creatorEmail:{type:String},creatorName:{type:String},creatorPhoto:{type:String},IsThisUser:{type:Boolean},userName:{type:String},userPicture:{type:String},userEmail:{type:String},attendedEventId:[{event_id:{type:String},event_name:{type:String},event_price:{type:String},event_photo:{type:String},event_host:{type:String},event_host_email:{type:String},event_host_photo:{type:String},event_dateStart:{type:Date},event_guestCancelled:{type:Boolean},event_hostDeleted:{type:Boolean},confirmed:{type:Boolean},pending:{type:Boolean},inquiry:{type:String}}],hostedEventId:{type:Array},rating:{type:Array}};e.exports={MongoRastr:t,indexHTML:'\n        <!DOCTYPE html>\n          <html lang="en">\n            <head>\n\n              <meta charset="utf-8">\n              <link rel="shortcut icon" href="party-marker.png">\n              <meta name="theme-color" content="#000000">\n              <meta name="viewport" content="width=device-width, user-scalable=no" />\n\n              <link rel="manifest" href="%PUBLIC_URL%/manifest.json">\n              <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">\n              <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">\n              <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">\n              <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"><\/script>\n              <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyADHzQ7cTn3uwDBUMoROC2JFdzZ_gEAzvI&libraries=places"><\/script>\n              <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"><\/script>\n              \n              <style>\n                  #wrap p {font-size: 15px; font-weight: 200 !important;}\n                  #wrap {display: inline-block; height: 150px; position: absolute; top: 25%; transform: translate(-50%, -50%);}\n                  #center{text-align: center;}\n              </style>\n              <title>Charlie party App</title>\n            </head>\n            <body>\n             <\/script>\n              <noscript>\n                You need to enable JavaScript to run this app.\n              </noscript>\n              <div id="center">\n              <div id="wrap">\n              <p><b>Charlie</b> &copy; 2019</p>\n              </div>\n              </div>\n              <div id="root"></div>\n\n              <script type="text/javascript" src="/infobubble.js"><\/script>\n              <script type="text/javascript" src="/bund.js"><\/script>\n            </body>\n          </html>\n      ',url:"mongodb+srv://party-admin:party-admin-heslo@cluster-party-app-fbuxs.mongodb.net/cluster-party-app?retryWrites=true"}},function(e,o,t){var n=t(19),s=t(2),r=t(1),a=t(18),i=t(17),d=t(0),l=t(5);d.connect(l.url,{useNewUrlParser:!0}),d.set("debug",!0);var c=new d.Schema(l.MongoRastr);c.index({geometry:"2dsphere"});var u=d.model("Party-collection",c);e.exports={PartyCollection:u};var y=t(16),g=t(13),p=t(9),b=s(),m=t(8);b.engine("handlebars",m()),b.set("views",r.join(__dirname,"views")),b.set("view engine","handlebars"),b.use(i("dev")),b.use(s.json()),b.use(s.urlencoded({extended:!1})),b.use(a()),b.use("/api2",p),b.use("/mail",g),b.use("/",y),b.use(s.static(r.join(__dirname,"public"))),b.use(s.static(r.join(__dirname,"public/client/dist")));var v=process.env.PORT||3003;b.listen(v,function(){console.log("Mixing it up on port ".concat(v))}),b.use(function(e,o,t){t(n(404))}),b.use(function(e,o,t,n){t.locals.message=e.message,t.locals.error="development"===o.app.get("env")?e:{},t.status(e.status||500),t.send("error z app.ks"),console.log("ERRORRRR: ",{err:e})})},function(e,o){e.exports=require("underscore")},function(e,o){e.exports=require("express-handlebars")},function(e,o,t){var n=t(2).Router(),s=(t(4),t(3).MongoClient,t(0),t(1),t(7)),r=(t(5),t(6));n.get("/",function(e,o,t){o.send("respond with a resource Maroubra")}),n.post("/get-user-info",function(e,o,t){console.log("api2/get-user-info ENDPOINT req.body: ",e.body),r.PartyCollection.find({userEmail:e.body.userEmail},function(e,t){console.log("err"),console.log(e),console.log("data"),console.log(t[0]),void 0==t[0]?console.log("Prazdna mnozina of results /user-info"):o.json({data:t})})}),n.post("/rating",function(e,o,t){console.log(" endpoint /rating - req.body: ",e.body);var n={guestId:e.body.guestId,guestName:e.body.guestName,guestPicture:e.body.guestPicture,ratedEventId:e.body.eventId,ratingCustom:e.body.rating,ratingComment:e.body.ratingComment};r.PartyCollection.updateOne({_id:e.body.creatorId},{$push:{rating:n}},function(e,t){console.log("RATED John PartyLiker"+t),o.json({data:t})})}),n.post("/boundaries",function(e,o,t){console.log("fetch Boundaries req.body",e.body),r.PartyCollection.find({dateStart:{$gte:e.body.startD,$lte:e.body.endD},hide:!1,geometry:{$geoWithin:{$geometry:{type:"Polygon",coordinates:[[[e.body.sw1,e.body.sw2],[e.body.ne1,e.body.sw2],[e.body.ne1,e.body.ne2],[e.body.sw1,e.body.ne2],[e.body.sw1,e.body.sw2]]]}}}},function(e,t){console.log("err"),console.log(e),console.log("docs"),console.log(t),o.json({docs:t})})}),n.post("/boundariesSingle",function(e,o,t){console.log("fetch Boundaries SINGLE req.body",e.body),r.PartyCollection.find({dateStart:{$gte:e.body.singleD,$lte:e.body.singleDTmr},hide:!1,IsThisUser:!1,geometry:{$geoWithin:{$geometry:{type:"Polygon",coordinates:[[[e.body.sw1,e.body.sw2],[e.body.ne1,e.body.sw2],[e.body.ne1,e.body.ne2],[e.body.sw1,e.body.ne2],[e.body.sw1,e.body.sw2]]]}}}},function(e,t){console.log("err"),console.log(e),console.log("docs"),console.log(t),o.json({docs:t})})}),n.post("/all-venues",function(e,o,t){console.log("fetch All venues SINGLE req.body",e.body),r.PartyCollection.find({dateStart:{$gte:e.body.singleD,$lte:e.body.singleDTmr},hide:!1,IsThisUser:!1},function(e,t){console.log("err"),console.log(e),console.log("docs"),console.log(t),o.json({docs:t})})}),n.post("/nearVenues",function(e,o,t){console.log("nearVenues endpoint!!"),console.log(e.body.workingLocationGate),r.PartyCollection.find({dateStart:{$gte:e.body.singleD,$lte:e.body.singleDTmr},hide:!1,IsThisUser:!1,geometry:{$nearSphere:{$geometry:{type:"Point",coordinates:[e.body.workingLocationGate[1],e.body.workingLocationGate[0]]}}}},function(e,t){console.log("err"),console.log(e),console.log("docs"),console.log(t),o.json({docs:t})}).limit(40)}),n.post("/user-info-id",function(e,o,t){console.log("Users- Info ENDPOINT req.body ",e.body),r.PartyCollection.find({_id:e.body.user_id},function(e,t){console.log("err"),console.log(e),console.log("data user-info-id :id"),console.log(t),void 0==t[0]&&console.log("Prazdna mnozina of results /api2/user-info-id"),o.json({data:t})})}),n.post("/cancel-guest",function(e,o,t){console.log("/api2/cancel-guest ENDPOINT req.body ",e.body),r.PartyCollection.updateOne({_id:e.body.eventId},{$pull:{EventGuests:{guest_id:e.body.user_id}}},function(e,o){console.log("EventGuests Updated ++ ParticipantEmail"+o)}),r.PartyCollection.update({_id:e.body.user_id,"attendedEventId.event_id":e.body.eventId},{$set:{"attendedEventId.$.event_guestCancelled":!0}},function(e,t){console.log("DELETED from USER attendedEventId err",e),console.log("DELETED from USER attendedEventId"+t),o.json({data:t})})}),n.post("/accept-guest",function(e,o,t){console.log("/api2/accept-guest ENDPOINT req.body ",e.body),r.PartyCollection.updateOne({_id:e.body.eventId,"EventGuests.guest_id":e.body.guest_id},{$set:{"EventGuests.$.guest_pending":!1,"EventGuests.$.guest_confirmed":!0}},function(e,o){console.log("Event EventGuests confirmed! "+o)}),r.PartyCollection.update({_id:e.body.guest_id,"attendedEventId.event_id":e.body.eventId},{$set:{"attendedEventId.$.confirmed":!0,"attendedEventId.$.pending":!1}},function(e,t){console.log("DELETED from USER attendedEventId err",e),console.log("DELETED from USER attendedEventId"+t),o.json({data:t})})}),n.post("/add-attend",function(e,o,t){console.log("jsme v add-attend ENDpoint"),console.log("REQ.BODY"),console.log(e.body);var n={guest_id:e.body.user_id,guest_email:e.body.user_email,guest_name:e.body.user_name,guest_photo:e.body.user_photo,guest_confirmed:!1,guest_pending:!0,guest_inquiry:e.body.inquiry};r.PartyCollection.updateOne({_id:e.body.event_id},{$push:{EventGuests:n}},function(e,o){console.log("EventGuests Updated ++ ParticipantEmail"+o)}),r.PartyCollection.updateOne({_id:e.body.user_id,"attendedEventId.event_id":e.body.event_id},{$set:{"attendedEventId.$.event_guestCancelled":!1}},function(t,n){if(console.log("/add-attend - GUEST PREVIOUSLY JOIN err",t),console.log("/add-attend - GUEST PREVIOUSLY JOIN data"),console.log(n),0==n.n){console.log("NOT PREVIOUSLY JOIN");var s={event_id:e.body.event_id,event_name:e.body.event_name,event_price:e.body.event_price,event_photo:e.body.event_photo,event_dateStart:e.body.event_dateStart,event_guestCancelled:!1,event_hostDeleted:!1,confirmed:!1,pending:!0,event_host:e.body.event_host,event_host_email:e.body.event_host_email,event_host_photo:e.body.event_host_photo,inquiry:e.body.inquiry};console.log("INSERting into her this bog boy: ",s),r.PartyCollection.updateMany({IsThisUser:!0,userEmail:e.body.user_email},{$push:{attendedEventId:s}},function(e,o){console.log("attendedEventId Hotovo add _id of Event"+o)})}o.json({data:n})})}),n.post("/event-info",function(e,o,t){console.log("/event-info EDNPOINT ",e.body),console.log("enevtId: ",e.body.eventId);e.body.eventId;r.PartyCollection.findOne({_id:e.body.eventId},function(e,t){console.log("err"),console.log(e),console.log("data event-info EDNPOINT"),console.log(t),void 0!==t?(console.log("/event-info EDNPOINT some DATA"),o.json({data:t})):(console.log("/event-info EDNPOINT keine 0 DATA"),o.status(311),o.send("NOTHING FOUND"))})}),n.post("/events-info-array",function(e,o,t){console.log("events-info-array EDNPOINT ",e.body);var n=[];s.map(e.body.eventsIdArr,function(e,o){e.event_guestCancelled||e.event_hostDeleted||n.push(e.event_id)}),r.PartyCollection.find({_id:n},function(e,t){console.log("/events-info-array - err"),console.log(e),console.log("/events-info-array - data"),console.log(t),o.json({data:t})})}),n.get("/info-stats",function(e,o,t){r.PartyCollection.find({},function(e,t){console.log("/events-info-array - err"),console.log(e),console.log("/events-info-array - data"),console.log(t),o.json({data:t})})}),e.exports=n},function(e,o){e.exports=require("nodemailer-express-handlebars")},function(e,o){e.exports=require("googleapis")},function(e,o){e.exports=require("nodemailer")},function(e,o,t){var n=t(2).Router(),s=(t(4),t(3).MongoClient,t(0),t(1),t(12)),r=t(11).google,a=t(10),i=new(0,r.auth.OAuth2)("119981354324-qlg4hf4dlb1k8dd7r32jkouoaoni0gt7.apps.googleusercontent.com","rJKG6kbFTkk80WCAaB1dKgAF","https://developers.google.com/oauthplayground");i.setCredentials({refresh_token:"1/51zxtNU8LnjfKH-7McNaqtWK6OCSK0X0vogDTcAhc0U"});var d=i.getAccessToken(),l=s.createTransport({service:"gmail",auth:{type:"OAuth2",user:"hoskovectest@gmail.com",clientId:"119981354324-qlg4hf4dlb1k8dd7r32jkouoaoni0gt7.apps.googleusercontent.com",clientSecret:"rJKG6kbFTkk80WCAaB1dKgAF",refreshToken:"1/51zxtNU8LnjfKH-7McNaqtWK6OCSK0X0vogDTcAhc0U",accessToken:d}});n.get("/",function(e,o,t){o.send("respond with a resource Maroubra")}),n.post("/post",function(e,o,t){console.log("mail/post ENDPOINT pOSt"),console.log("body._id: ",e.body.event._id),l.use("compile",a({viewEngine:{extName:".handlebars",partialsDir:"./views/",layoutsDir:"./views/"},viewPath:"views"}));var n="https://www.charlieparty.club/event/"+e.body.event._id;console.log("mail/post ENDPOINT pOSt: eventURL ",n);var s={from:"Charlie Party App",to:e.body.user_email,subject:"You just created CHARLIE event",template:"monkey",context:{eventURL:n,user_name:e.body.user_name,event_name:e.body.event.name,dateStart:e.body.event.dateStart,dateEnd:e.body.event.dateEnd,repeatWeek:e.body.event.repeatWeek,price:e.body.event.price,capacityMax:e.body.event.capacityMax,freeSnack:e.body.event.freeSnack,freeBeer:e.body.event.freeBeer,freeMeal:e.body.event.freeMeal,description:e.body.event.description,addressGoogle:e.body.event.addressGoogle,addressCustom:e.body.event.freeaddressCustomMeal,creatorName:e.body.event.creatorName,creatorPhoto:e.body.event.creatorPhoto}};l.sendMail(s,function(e,t){e?(console.log(e),o.json({error:e})):(o.json({response:t}),console.log("response NODE:",t),l.close())})}),n.post("/inquiry-to-host",function(e,o,t){console.log("mail/inquiry-to-host ENDPOINT!!"),console.log("body: ",e.body),l.use("compile",a({viewEngine:{extName:".handlebars",partialsDir:"./views/",layoutsDir:"./views/"},viewPath:"views"}));var n="https://www.charlieparty.club/event/"+e.body.event._id;console.log("mail/post ENDPOINT pOSt: eventURL ",n);var s={from:"Charlie Party App",to:e.body.event.creatorEmail,subject:"Guests Pending Inquiry (CHARLIE PARTY)",template:"inquiry",context:{eventURL:n,guest_name:e.body.guest_name,guest_email:e.body.guest_email,guest_picture:e.body.guest_picture,guest_inquiry:e.body.guest_inquiry,event_name:e.body.event.name,dateStart:e.body.event.dateStart,dateEnd:e.body.event.dateEnd,repeatWeek:e.body.event.repeatWeek,price:e.body.event.price,capacityMax:e.body.event.capacityMax,addressGoogle:e.body.event.addressGoogle,addressCustom:e.body.event.freeaddressCustomMeal,creatorName:e.body.event.creatorName,creatorPhoto:e.body.event.creatorPhoto}};l.sendMail(s,function(e,t){e?(console.log(e),o.json({error:e})):(o.json({response:t}),console.log("response NODE:",t),l.close())})}),n.post("/inquiry-to-guest",function(e,o,t){console.log("mail/inquiry-to-guest ENDPOINT!! email for: ",e.body.guest_email),console.log("body: ",e.body),l.use("compile",a({viewEngine:{extName:".handlebars",partialsDir:"./views/",layoutsDir:"./views/"},viewPath:"views"}));var n="https://www.charlieparty.club/event/"+e.body.event._id;console.log("mail/post ENDPOINT pOSt: eventURL ",n);var s={from:"Charlie Party App",to:e.body.guest_email,subject:"copy of your inquiry (CHARLIE PARTY)",template:"inquiry",context:{eventURL:n,guest_name:e.body.guest_name,guest_email:e.body.guest_email,guest_picture:e.body.guest_picture,guest_inquiry:e.body.guest_inquiry,event_name:e.body.event.name}};l.sendMail(s,function(e,t){e?(console.log(e),o.json({error:e})):(o.json({response:t}),console.log("response NODE:",t),l.close())})}),n.post("/access-granted",function(e,o,t){console.log("mail/access-granted ENDPOINT!! email for: ",e.body.guest_email),console.log("body: ",e.body),l.use("compile",a({viewEngine:{extName:".handlebars",partialsDir:"./views/",layoutsDir:"./views/"},viewPath:"views"}));var n="https://www.charlieparty.club/event/"+e.body.event._id;console.log("mail/post ENDPOINT pOSt: eventURL ",n);var s={from:"Charlie Party App",to:e.body.guest_email,subject:"Access Granted (CHARLIE PARTY)",template:"granted",context:{eventURL:n,guest_name:e.body.guest_name,event_name:e.body.event_name,creatorName:e.body.event.creatorName,creatorEmail:e.body.event.creatorEmail}};l.sendMail(s,function(e,t){e?(console.log(e),o.json({error:e})):(o.json({response:t}),console.log("response NODE:",t),l.close())})}),n.post("/postquestion",function(e,o,t){console.log("mail/post ENDPOINT pOSt"),console.log("body._id: ",e.body.guestEmail),console.log("body._id: ",e.body.question),l.use("compile",a({viewEngine:{extName:".handlebars",partialsDir:"./views/",layoutsDir:"./views/"},viewPath:"views"}));var n={from:"Charlie Party App",to:"ihoskovecpetr@gmail.com",subject:"Charlie Question",template:"monkey",context:{user_name:e.body.guestEmail,description:e.body.question}};l.sendMail(n,function(e,t){e?console.log(e):(o.json({response:t}),console.log("response NODE:",t),l.close())})}),e.exports=n},function(e,o){e.exports=require("request")},function(e,o){e.exports=require("serve-index")},function(e,o,t){var n=t(2),s=n.Router(),r=n(),a=t(1),i=t(4);t(3).MongoClient;t(0).Promise=global.Promise;var d=t(15),l=t(7),c=(t(14),t(5)),u=t(6);r.use("/.well-known",n.static(".well-known"),d(".well-known")),r.use("/img",n.static("img"),d("img")),s.use(i.urlencoded({extended:!0})),s.use(i.json()),console.log("1!"),s.use(n.static(a.join(__dirname,"public/"))),s.use(n.static(a.join(__dirname,"public/dist"))),s.get("/",function(e,o,t){console.log("/ ENDPOINT index.js"),o.sendFile(a.join(__dirname+"/public/dist/index.html"))}),s.get("/event/:id",function(e,o,t){console.log("/event/:id ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/map",function(e,o,t){console.log("/map ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/user-profile",function(e,o,t){console.log("/user ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/create",function(e,o,t){console.log("/create ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/login",function(e,o,t){console.log("/login ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/about",function(e,o,t){console.log("/about ENDPOINT index.js req.path: ",e.path),o.send(c.indexHTML)}),s.get("/delete-all",function(e,o,t){console.log("delete-all endpoint req.body: ",e.body),u.PartyCollection.deleteMany({},function(e,t){console.log("DELETEDDD"+t),o.json({delData:t})})}),s.post("/custom-party",function(e,o,t){console.log("jsme v custom-point PARTY APPPP"),console.log("REQ.BODY @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ type"),console.log(e.body);var n=new Date;console.log("date FORM, date START +  new Date(): ",e.body.dateStart,n),u.PartyCollection.find({dateStart:{$gte:n},hide:!1,geometry:{$nearSphere:{$geometry:{type:"Point",coordinates:[e.body.lat,e.body.lng]},$maxDistance:1}}},function(t,n){console.log("err"),console.log(t),console.log("docs[0]"),console.log(n[0]),void 0!==n[0]&&n[0]._id.toString()!==e.body.updating_id?(o.status(311),o.send("STATUS 311, found some close point")):e.body.isUpdating?(console.log("/custom-party - endpoint for : req.body.isUpdating = true "),u.PartyCollection.updateOne({_id:e.body.updating_id},{"geometry.coordinates":[e.body.lat,e.body.lng],name:e.body.name,dateStart:e.body.dateStart,dateEnd:e.body.dateEnd,repeatWeek:e.body.repeatWeek,price:e.body.price,capacityMax:e.body.capacityMax,BYO:e.body.BYO,freeSnack:e.body.freeSnack,freeBeer:e.body.freeBeer,freeMeal:e.body.freeMeal,imagesArr:e.body.imagesArr,description:e.body.description,addressGoogle:e.body.addressGoogle,addressCustom:e.body.addressCustom,confirmed:e.body.confirmed,eventType:e.body.eventType,hide:e.body.hide,creatorEmail:e.body.creatorEmail,creatorName:e.body.creatorName,creatorPhoto:e.body.creatorPhoto,IsThisUser:!1,userName:e.body.userName,userPicture:e.body.userPicture,userEmail:e.body.userEmail,attendedEventId:e.body.attendedEventId,hostedEventId:e.body.hostedEventId,rating:e.body.rating},function(e,t){console.log("err /custom-party:updating"),console.log(e),console.log("data /custom-party:updating"),console.log(t),o.json({data:t})})):u.PartyCollection.create({"geometry.coordinates":[e.body.lat,e.body.lng],name:e.body.name,dateStart:e.body.dateStart,dateEnd:e.body.dateEnd,repeatWeek:e.body.repeatWeek,price:e.body.price,capacityMax:e.body.capacityMax,EventGuests:e.body.EventGuests,BYO:e.body.BYO,freeSnack:e.body.freeSnack,freeBeer:e.body.freeBeer,freeMeal:e.body.freeMeal,imagesArr:e.body.imagesArr,description:e.body.description,addressGoogle:e.body.addressGoogle,addressCustom:e.body.addressCustom,eventType:e.body.eventType,confirmed:e.body.confirmed,hide:e.body.hide,creator_id:e.body.creator_id,creatorEmail:e.body.creatorEmail,creatorName:e.body.creatorName,creatorPhoto:e.body.creatorPhoto,IsThisUser:!1,userName:e.body.userName,userPicture:e.body.userPicture,userEmail:e.body.userEmail,hostedEventId:e.body.hostedEventId,rating:e.body.rating},function(t,n){console.log("EVENT typke: ",e.body.eventType),console.log("err /add-custom-party SSSS"),console.log(t),console.log("data /add-custom-party"),console.log(n),console.log("data._id XXXXXXX"),console.log(n._id),o.json({data:n})})}).limit(1)}),s.post("/add-user",function(e,o,t){console.log("jsme v add-user, REQ.BODY:",e.body),u.PartyCollection.find({IsThisUser:!0,userEmail:e.body.userEmail},function(t,n){console.log("ERR search for user",t),console.log("DATA search for user",n),void 0==n[0]?(console.log("ADDing NEW USER"),u.PartyCollection.create({"geometry.coordinates":[e.body.lat,e.body.lng],dateStart:e.body.dateStart,confirmed:!0,hide:!1,IsThisUser:!0,userName:e.body.userName,userPicture:e.body.userPicture,userEmail:e.body.userEmail,attendedEventId:[],hostedEventId:[]},function(e,t){console.log("ERR AppObj.PartyCollection.create",e),console.log("DATA AppObj.PartyCollection.create NEW USER",t),o.json({data:t})})):(console.log("This USER ALREADY EXIST, send DATA: "),console.log(n),o.json({data:n[0]}))})}),s.post("/user-info",function(e,o,t){console.log("users-info ENDPOINT req.body: ",e.body),u.PartyCollection.find({userEmail:e.body.userEmail},function(e,t){console.log("err"),console.log(e),console.log("data"),console.log(t[0]),void 0==t[0]&&console.log("Prazdna mnozina of results /user-info"),o.json({data:t})})}),s.post("/users-info-array",function(e,o,t){console.log("users-info-array ENDPOINT req.body.userEmail ",e.body.userEmail);var n=[];l.map(e.body.userEmail,function(e,o){return n.push(e)}),console.log("QUERY tyhle maily ",n),u.PartyCollection.find({userEmail:n,IsThisUser:!0},function(e,t){console.log("err"),console.log(e),console.log("data"),console.log(t),void 0==t[0]?console.log("Prazdna mnozina of results /users-info-array"):o.json({data:t})})}),s.post("/confirm-event",function(e,o,t){console.log("/confirm-event ENDPOINT req.body ",e.body),u.PartyCollection.updateOne({_id:e.body.event_id},{$set:{confirmed:!0}},function(e,t){console.log("/api/delete-event - GUEST Update err",e),console.log("/api/delete-event - GUEST Update data",t),console.log(t),o.json({data:t})})}),s.post("/user-hosted",function(e,o,t){console.log("User-Hosted ENDPOINT req.body ",e.body),u.PartyCollection.find({creatorEmail:e.body.userEmail,hide:!1},function(e,t){console.log("err"),console.log(e),console.log("data"),console.log(t[0]),void 0==t[0]&&console.log("Prazdna mnozina of results /user-hosted"),o.json({data:t})})}),s.post("/delete-event",function(e,o,t){console.log("/delete-event ENDPOINT req.body ",e.body),u.PartyCollection.updateOne({_id:e.body.eventId},{$set:{hide:!0}},function(e,o){console.log("/api/delete-event - GUEST Update err",e),console.log("/api/delete-event - GUEST Update data"+o)}),u.PartyCollection.updateMany({"attendedEventId.event_id":e.body.eventId},{$set:{"attendedEventId.$.event_hostDeleted":!0}},function(e,t){console.log("/api/delete-event - GUEST Update err",e),console.log("/api/delete-event - GUEST Update data"+t),o.json({data:t})})}),s.post("/events-info-array",function(e,o,t){console.log("events-info-array EDNPOINT ",e.body);var n=[];l.map(e.body.eventsIdArr,function(e,o){e.event_guestCancelled||e.event_hostDeleted||n.push(e.event_id)}),u.PartyCollection.find({_id:n},function(e,t){console.log("/events-info-array - err"),console.log(e),console.log("/events-info-array - data"),console.log(t),o.json({data:t})})}),s.get("/*",function(e,o,t){return console.log("Catched, redirected to home '/' "),o.redirect("/")}),s.use(n.static(a.join(__dirname,"public/client/dist"))),e.exports=s},function(e,o){e.exports=require("morgan")},function(e,o){e.exports=require("cookie-parser")},function(e,o){e.exports=require("http-errors")}]);